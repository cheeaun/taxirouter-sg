<!DOCTYPE html><html><head><title>TaxiRouter SG - live available taxi locations in Singapore</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta name="description" content="Explore available taxis and taxi stands in Singapore">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="TaxiRouter SG">
<!-- metacrap: https://adactio.com/journal/9881 -->
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="TaxiRouter SG">
<meta name="twitter:url" property="og:url" content="https://taxirouter.sg">
<meta name="twitter:title" property="og:title" content="TaxiRouter SG">
<meta name="twitter:description" property="og:description" content="Explore available taxis and taxi stands in Singapore">
<meta name="twitter:image" property="og:image" content="https://taxirouter.sg/assets/preview.png">
<!-- end metacrap -->
<link rel="stylesheet" href="https://api.tiles.mapbox.com/mapbox-gl-js/v0.44.1/mapbox-gl.css">
<style>body,html{height:100%;margin:0;padding:0;background-color:#0c0d0e}body,button,input{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif}a{color:#4285f4;text-decoration:none}a:hover{text-decoration:underline}button{font-size:1em;cursor:pointer;border:1px solid #4285f4;border-radius:5px;padding:10px;color:#4285f4;background-color:transparent;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background-color:#fff}button:active{color:#fff;background-color:#4285f4}*{box-sizing:border-box}header{padding:10px;cursor:pointer;position:absolute;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;z-index:1}header:active{opacity:.7}header h1{margin:0;padding:0;-webkit-filter:drop-shadow(0 2px 4px rgba(0,0,0,.2));filter:drop-shadow(0 2px 4px rgba(0,0,0,.2))}header svg{vertical-align:top}#about{color:#333;background-color:rgba(255,255,255,.9);position:absolute;top:0;left:0;width:100%;max-height:100%;overflow:auto;z-index:3;padding:15px;-webkit-transition:-webkit-transform .3s cubic-bezier(.15,.78,.18,1.17);transition:transform .3s cubic-bezier(.15,.78,.18,1.17);-webkit-transform:translate3d(0,-100%,0);transform:translate3d(0,-100%,0);pointer-events:none;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}#about.show{transform:translate3d(0,0,0);-webkit-transform:translate3d(0,0,0);pointer-events:auto}@media screen and (min-width:500px) and (min-height:500px){#about{width:500px;left:50%;margin-left:-250px;border-radius:12px}#about.show{transform:translate3d(0,15px,0);-webkit-transform:translate3d(0,15px,0)}}#about h2,#about h3{margin:0;padding:0 0 .5em}#about p{margin:0;padding:0 0 .5em;line-height:1.4}#about ul{list-style:none;margin:0 0 5px;padding:0}#about ul li{display:inline-block;margin-right:1em}#about ul li img{vertical-align:middle;margin:0 3px}#about button{width:100%;margin:0}#preview{float:right;border:1px solid #999;margin-left:10px;margin-top:5px}#map{position:absolute;top:0;bottom:0;width:100%}#info-taxis{pointer-events:none;font-size:.85em;position:absolute;bottom:20px;right:68px;margin-left:10px;border-radius:12px;padding:10px;text-align:right;color:rgba(255,255,255,.8);background-color:rgba(0,0,0,.5);-webkit-backdrop-filter:blur(10px) saturate(50%);backdrop-filter:blur(10px) saturate(50%);-webkit-transition:opacity .3s;transition:opacity .3s;-webkit-animation:blink .75s linear infinite alternate;animation:blink .75s linear infinite alternate}#info-taxis.loaded{-webkit-animation:jump .3s;animation:jump .3s}@-webkit-keyframes blink{0%{opacity:1}50%{opacity:.2}100%{opacity:1}}@keyframes blink{0%{opacity:1}50%{opacity:.2}100%{opacity:1}}@-webkit-keyframes jump{0%{transform:translateY(0)}25%{transform:translateY(-10px)}50%{transform:translateY(0)}75%{transform:translateY(-3px)}100%{transform:translateY(0)}}@keyframes jump{0%{transform:translateY(0)}25%{transform:translateY(-10px)}50%{transform:translateY(0)}75%{transform:translateY(-3px)}100%{transform:translateY(0)}}#location{display:none;outline:0;position:absolute;bottom:20px;right:10px;z-index:1;border:0;padding:12px;margin:0;width:48px;height:48px;background-color:#fff;border-radius:50%;overflow:hidden;box-shadow:0 2px 4px rgba(0,0,0,.2);vertical-align:top;transition:transform .3s ease}#location svg{fill:#666}#location .compass,#location.compass .location{display:none}#location.compass .compass{display:block}#location.locating{pointer-events:none}#location.locating svg{-webkit-animation:rotate 5s infinite both linear;animation:rotate 5s infinite both linear}@-webkit-keyframes rotate{0%{transform:rotate(0)}100%{transform:rotate(1turn)}}@keyframes rotate{0%{transform:rotate(0)}100%{transform:rotate(1turn)}}#location.active svg{fill:#4285f4}#bounds-warning{position:absolute;bottom:30px;left:10px;display:none;padding:10px;background-color:rgba(0,0,0,.7);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);color:#fff}#bounds-warning button{display:inline;padding:0;border:0;color:#fff;background-color:transparent;text-decoration:underline}#bounds-warning.visible{display:block}.mapboxgl-ctrl-attrib{margin-top:10px!important}</style>
<link rel="canonical" href="https://taxirouter.sg">
<link rel="dns-prefetch" href="https://api.data.gov.sg">
</head><body><header id="heading">
  <h1>
    <svg viewBox="0 0 48 48" width="48" height="48">
      <title>TaxiRouter SG</title>
      <circle cx="24" cy="24" r="22.7" fill="#fff" stroke="#00454d" stroke-width="2.6"/>
      <path fill="#00454d" d="M32.92 16.28c-.26-.76-.98-1.302-1.83-1.302h-3.223V12.4h-7.734v2.578H16.91c-.85 0-1.558.54-1.83 1.302L12.4 24v10.31c0 .71.58 1.29 1.29 1.29h1.288c.71 0 1.29-.58 1.29-1.29v-1.288h15.465v1.29c0 .708.58 1.288 1.29 1.288h1.288c.71 0 1.29-.58 1.29-1.29V24l-2.68-7.72zM16.91 29.156c-1.07 0-1.932-.864-1.932-1.934 0-1.07.863-1.933 1.933-1.933s1.94.86 1.94 1.93c0 1.07-.86 1.93-1.93 1.93zm14.18 0c-1.07 0-1.934-.864-1.934-1.934 0-1.07.863-1.933 1.933-1.933s1.93.86 1.93 1.93c0 1.07-.87 1.93-1.94 1.93zM14.977 22.71l1.933-5.8h14.18l1.932 5.8H14.978z"/>
      <circle cx="38.4" cy="38.4" r="9.6" fill="#ef2c2e"/>
      <path fill="#fff" d="M35.042 42.152c-.563 0-1.102-.096-1.616-.287-.514-.19-.99-.485-1.428-.88l.772-.918c.354.306.712.54 1.073.704.36.17.772.25 1.23.25.396 0 .71-.08.943-.25.233-.16.35-.39.35-.66v-.02c0-.13-.024-.25-.07-.35-.044-.1-.128-.19-.25-.28-.122-.09-.29-.17-.5-.25-.213-.07-.49-.15-.832-.23-.39-.09-.736-.19-1.04-.3-.302-.11-.556-.25-.762-.41-.205-.16-.362-.36-.47-.6-.108-.23-.162-.52-.162-.85v-.02c0-.32.062-.6.186-.86s.295-.49.51-.67c.218-.18.48-.33.785-.43.31-.1.64-.16 1-.16.54 0 1.02.08 1.45.24.43.16.83.39 1.21.69l-.68.97c-.33-.24-.66-.43-.99-.56-.32-.13-.65-.19-.99-.19-.37 0-.66.09-.87.25-.2.17-.31.37-.31.62v.02c0 .14.03.26.08.37.05.11.14.21.27.29.13.09.31.17.54.25.23.08.51.16.86.24.39.1.73.21 1.02.32.3.12.54.26.74.43.2.17.35.37.45.6.1.23.15.49.15.79 0 .34-.06.65-.19.92s-.3.5-.53.69c-.23.19-.5.33-.82.43-.32.1-.67.15-1.05.15m6.71.02c-.57 0-1.08-.09-1.55-.28-.46-.19-.86-.46-1.19-.79-.33-.34-.58-.74-.76-1.19-.18-.46-.27-.95-.27-1.49v-.02c0-.51.09-.99.27-1.45.19-.46.45-.86.79-1.21.34-.34.74-.62 1.2-.82.46-.2.97-.3 1.52-.3.32 0 .61.02.87.07.26.04.5.11.72.19.22.08.43.18.63.3s.39.26.58.42l-.81.97c-.14-.12-.28-.23-.43-.32-.15-.1-.3-.18-.46-.25-.16-.07-.34-.12-.53-.16-.19-.04-.4-.06-.63-.06-.33 0-.64.07-.93.21-.29.14-.54.32-.75.56-.21.23-.38.5-.5.82-.12.31-.18.64-.18.99v.02c0 .38.06.72.18 1.04.12.32.29.6.51.83.22.23.48.41.78.55.3.13.64.2 1.02.2.35 0 .67-.05.97-.15.31-.1.57-.23.79-.4v-1.4h-1.9v-1.11h3.1v3.07c-.18.15-.38.3-.6.44-.21.14-.45.26-.7.37-.25.11-.53.19-.82.25-.29.06-.59.09-.91.09"/>
    </svg>
  </h1>
</header>
<div id="about">
  <img id="preview" src="assets/preview.jpg" width="160" height="160" alt="">
  <h2>TaxiRouter SG</h2>
  <p><strong>Explore</strong> available taxis and taxi stands in Singapore. <b>Zoom in</b> to see nearby available taxis, taxi stands and traffic information around you.</p>
  <p><a href="https://github.com/cheeaun/taxirouter-sg" target="_blank">Yet another project</a> by <a href="https://twitter.com/cheeaun" target="_blank">@cheeaun</a>. <a href="http://cheeaun.com/blog/2016/03/building-taxirouter-sg/" target="_blank">Read the story on how this is built</a>. Data is copyrighted by the <a href="http://www.lta.gov.sg/" target="_blank">Land Transport Authority</a>.</p>
  <p>Sister sites: <a href="https://busrouter.sg/" target="_blank">&#x1F68D; BusRouter SG</a> <a href="https://railrouter.sg/" target="_blank">&#x1F686; RailRouter SG</a></p>
  <h3>Legend</h3>
  <ul>
    <li><img src="assets/taxi-stand.png" width="15" height="23" alt=""> Taxi stand</li>
    <li><img src="assets/taxi.png" width="9" height="8" alt=""> Taxi</li>
    <li><img src="assets/taxi-stationary.png" width="9" height="8" alt=""> Stationary taxi</li>
  </ul>
  <p><small>Note: &apos;Stationary taxi&apos; is a taxi that hasn&apos;t moved from its location for one minute.</small></p>
  <p><button id="about-okay" ontouchstart="">Okay</button></p>
</div>
<div id="map"></div>
<button id="location" title="Show current location">
  <svg width="24" height="24" viewBox="0 0 24 24">
    <path d="M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z" class="location"/>
    <path d="M14.19,14.19L6,18L9.81,9.81L18,6M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,10.9A1.1,1.1 0 0,0 10.9,12A1.1,1.1 0 0,0 12,13.1A1.1,1.1 0 0,0 13.1,12A1.1,1.1 0 0,0 12,10.9Z" class="compass"/>
  </svg>
</button>
<div id="info-taxis">Loading&#x2026;</div>
<div id="bounds-warning">Looks like you&apos;re lost.<br><button id="back-sg">Go back to Singapore</button>.</div>
<script>var taxiStandsOnMap=[[103.83387234072,1.30429251101406],[103.836057298702,1.30364031324823],[103.835693718294,1.30705658427793],[103.835930874103,1.30452165570791],[103.835546677871,1.30456462093248],[103.83765495747,1.30303742217855],[103.835799465402,1.30198731673367],[103.832751722991,1.30371290605001],[103.834397136841,1.30232574695198],[103.839571139812,1.30120337531623],[103.840586035522,1.30287430859384],[103.842266084874,1.30090718307585],[103.840960744274,1.30257832712301],[103.845488177553,1.30025866050311],[103.845223256871,1.30050680633466],[103.847327169012,1.29930873943486],[103.844954718055,1.29815662992004],[103.843945010584,1.29698851682493],[103.842366680253,1.29980843622966],[103.840325880621,1.30031769005559],[103.849373495468,1.29865536276609],[103.849682236075,1.30055972591397],[103.85096346414,1.30295008824425],[103.852377477233,1.30151265890506],[103.850282255203,1.2985006805551],[103.849098998462,1.29768272298103],[103.849353257593,1.2975294955709],[103.850414072502,1.29617233399305],[103.852195771133,1.29807150568094],[103.852655217489,1.29998360991225],[103.855300383639,1.29826134856261],[103.856390064813,1.29894453297921],[103.856926642278,1.29710383108526],[103.85539290285,1.29624719984175],[103.852943136075,1.29737643300251],[103.852624360399,1.29562777476712],[103.851245578793,1.30012318744093],[103.845992154615,1.29121268923792],[103.845263369874,1.29177315666165],[103.844979796753,1.29111387313995],[103.844971511221,1.29073604580684],[103.848092284926,1.29465884235551],[103.849276461011,1.2942109389154],[103.849478388053,1.29187361712363],[103.850370848721,1.29197869865702],[103.850466197796,1.29115532879644],[103.852011934768,1.28760592304216],[103.853887608599,1.29114020012761],[103.851509689713,1.2913250595032],[103.851440019675,1.29273255393444],[103.852693883979,1.2935184503127],[103.852756521798,1.29426458546323],[103.853733300557,1.29437678787745],[103.853675972427,1.29330014202904],[103.858698372944,1.29543699354907],[103.859553594449,1.29492439269757],[103.860593487566,1.29262371295208],[103.859887275298,1.29155225049403],[103.858356643234,1.29139138284688],[103.857439640066,1.29180512767506],[103.856581346912,1.28982563808021],[103.856733448259,1.29280234412988],[103.846001470387,1.29630527715055],[103.840582933231,1.28040038369394],[103.841818487018,1.27886257384486],[103.840854925149,1.28206841727511],[103.841681244819,1.28178206052514],[103.842314857654,1.28363646069435],[103.843198771366,1.28536568536571],[103.843934700241,1.28609647427804],[103.844743305286,1.28547620680909],[103.84476283019,1.28741244899171],[103.842618875804,1.28918484589333],[103.844126139158,1.28921666575511],[103.845928070128,1.2890266029571],[103.848150185878,1.2889512123112],[103.84749234893,1.28840728799318],[103.847020924218,1.28697215748064],[103.84534778464,1.28253210794219],[103.844337825731,1.28126999002797],[103.84404706879,1.28286546740439],[103.844038244737,1.28428858776696],[103.846262399419,1.28247781918789],[103.843272028393,1.28350816024261],[103.847431204813,1.28514181015025],[103.846582674268,1.28349422554159],[103.848587843337,1.28584653738451],[103.850262115505,1.28422258746945],[103.847443925376,1.28144232577785],[103.848778080785,1.28253566711523],[103.848018730157,1.27895794376436],[103.848666499783,1.2800707607133],[103.849897903554,1.28210362779366],[103.851239838467,1.28348118708103],[103.853717432581,1.28575962794076],[103.852182321829,1.28522773490074],[103.848509300564,1.27816220507103],[103.849288151202,1.27942694804677],[103.851470609648,1.28160808749498],[103.852151501022,1.28124217521129],[103.849874228117,1.27901508799806],[103.848888122367,1.27745186202144],[103.846992510702,1.27464603568998],[103.844169072884,1.27875668993253],[103.843119599294,1.27785901543147],[103.842011388214,1.27422682548758],[103.843313313157,1.27512362438661],[103.843242407843,1.27578545319013],[103.84508131647,1.27835562881702],[103.843779616283,1.27345494090479],[103.845023638505,1.27382905941209],[103.846184991128,1.27574664904182],[103.847527033695,1.27730149272449],[103.852737971828,1.28418877920079],[103.848912190025,1.28799130416516],[103.843722867275,1.27787170762217],[103.848807630899,1.28685389981132],[103.850687901883,1.28043066615895],[103.85282628302079,1.28342933345672],[103.84383197198764,1.2787643196673],[103.844544760759,1.38201956220883],[103.849249165493,1.37011680755576],[103.849145624618,1.35064124611013],[103.847751088882,1.35139355898837],[103.848112044527,1.35153997158924],[103.850395554463,1.33420736240968],[103.846038678868,1.34103786292502],[103.847067121877,1.33378960563771],[103.849731707365,1.33118361060148],[103.83131858099,1.35493312006533],[103.855022923731,1.32281877961387],[103.850804611434,1.32469139610575],[103.884866285951,1.38338689258473],[103.863421901037,1.31825710100276],[103.862553816484,1.30694359577781],[103.8619107552,1.31978779067631],[103.854855947083,1.31086798265317],[103.855976800881,1.31090083119856],[103.861428623869,1.30321523073406],[103.864770049764,1.30295363191655],[103.8633093012,1.29960155793034],[103.851619496856,1.30521746517692],[103.853056217115,1.30346274389145],[103.835680504393,1.31640274596551],[103.849466020668,1.30570613468817],[103.84999151155,1.30702761730185],[103.853430969361,1.31281691307843],[103.820610240425,1.26462285529129],[103.82017831635,1.27620578703704],[103.821504995893,1.26589171568534],[103.834613647793,1.27850229295971],[103.83923085771,1.28106965308459],[103.834788338807,1.28880444137122],[103.827906281357,1.28656044626585],[103.832600325392,1.28468738161671],[103.816904333926,1.28285666560423],[103.824881956194,1.27409678101459],[103.817183017467,1.28922698782741],[103.798709766255,1.30247814614698],[103.797990258551,1.30236444160154],[103.805529976741,1.2950323416851],[103.806501020838,1.29422821938586],[103.80344541129,1.28828181267061],[103.790195997629,1.30641446598866],[103.825128103091,1.29334161406726],[103.822661638265,1.29990623117205],[103.830413486679,1.30515143316239],[103.82913505882,1.30726269670246],[103.820086626041,1.30737440136464],[103.833260002388,1.30722105839897],[103.837714785686,1.31193941548],[103.837466221531,1.31220498806888],[103.826829601391,1.30643505812543],[103.824069949702,1.30517936255322],[103.814535907055,1.32155434412126],[103.83948529235,1.33769592088785],[103.82307,1.26497],[103.868956140587,1.33252529604359],[103.869362831205,1.33162040663414],[103.870544100226,1.33904082961601],[103.870633511689,1.3532574092896],[103.872823868701,1.3509951192406],[103.874316700695,1.35064962891504],[103.874123133099,1.34947087540943],[103.864668030681,1.35152785589167],[103.877165572661,1.35457543114927],[103.884366032897,1.35980625308547],[103.884689456201,1.35956044888902],[103.892586093925,1.37145326525464],[103.893189212891,1.38265352177454],[103.89293396663,1.38248036427324],[103.90126216014,1.38531835849613],[103.895611691027,1.39247875930078],[103.896004248686,1.39269112558388],[103.895177298646,1.39072520526225],[103.901921255914,1.40565348941188],[103.902646405824,1.40483423034297],[103.864645163562,1.41956340864069],[103.948711679146,1.37236128171586],[103.949737794757,1.37270370763084],[103.787885176419,1.31176679451075],[103.792999447198,1.31015380574819],[103.795433986026,1.31004259901136],[103.786077434806,1.31782171735428],[103.807223557845,1.31731582190959],[103.775747865198,1.34323207217204],[103.833028363828,1.4171176157976],[103.835171681874,1.42887732124926],[103.834575583921,1.43029754760739],[103.836768990917,1.42937305212216],[103.829857142122,1.4589896841015],[103.824378024257,1.44181998970666],[103.820233436663,1.44938297069083],[103.80134402714,1.44101730946656],[103.787228039509,1.43720710992823],[103.785067072321,1.43642610917054],[103.769585603936,1.44359748657376],[103.77379091699,1.43239290772013],[103.762273387818,1.42561248188864],[103.761163798858,1.4219620705613],[103.986741800399,1.38970492435793],[103.960849641193,1.3358126638666],[103.945189862184,1.35232044254886],[103.952822166945,1.34247211029648],[103.946271977177,1.32680767718394],[103.94596319775,1.32729181077614],[103.931477153745,1.32450273190175],[103.929532923134,1.32363096079051],[103.925224599944,1.33106098400788],[103.924036735496,1.33809843799672],[103.938631004254,1.31206495035033],[103.922605715552,1.30817411128662],[103.914781478711,1.30517894855803],[103.909010064601,1.30485853994214],[103.904863758429,1.30217537889763],[103.901395182311,1.30385068066442],[103.9124285657,1.32074573869768],[103.897985783481,1.31773065744351],[103.895241060737,1.31725988619512],[103.894055823822,1.31475853356732],[103.894299357187,1.31470242564641],[103.891799301916,1.3182688354494],[103.89329475005,1.31848157860162],[103.887282588659,1.31918240728325],[103.883154595275,1.31597125693391],[103.880348416617,1.34239684293689],[103.889484662444,1.30864966860135],[103.876041925861,1.30143795122954],[103.751490354444,1.35860260502394],[103.743798508905,1.38427287921263],[103.747531747627,1.39716085402784],[103.781211623366,1.28374867003747],[103.778143517761,1.31141844617024],[103.779156490511,1.31140900063671],[103.765360857385,1.31425160644327],[103.742679309513,1.33231677185113],[103.740605199084,1.3335937382006],[103.725065352927,1.3501584451506],[103.732062454655,1.34295777055706],[103.720806459054,1.34453911381439],[103.706547273572,1.33809311867971],[103.707038266053,1.33797570886111],[103.707011357932,1.33905753045831],[103.697685976483,1.3377861621144],[103.67876006073,1.32758804456683],[103.678484752704,1.33072939816997],[103.78170004311644,1.28328503345734]]</script>
<script src="https://api.tiles.mapbox.com/mapbox-gl-js/v0.44.1/mapbox-gl.js"></script>
<script src="https://unpkg.com/@turf/turf@5.1.6/turf.min.js"></script>
<script>function $(t){return document.getElementById(t)}function debounce(t,a,o){var e;return function(){var i=this,n=arguments;clearTimeout(e),e=setTimeout(function(){e=null,o||t.apply(i,n)},a),o&&!e&&t.apply(i,n)}}function numberWithCommas(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}var taxisOnMap,fiveMinCircle,currentLocation,$infoTaxis=$("info-taxis"),$location=$("location"),fiveMinDistance=400,emptyGeojson={type:"geojson",data:{type:"Feature"}},$about=$("about"),$aboutOkay=$("about-okay"),$header=$("heading"),toggleAbout=function(){$about.classList.toggle("show")};function fetchTaxis(t){var a=new XMLHttpRequest;a.onload=function(){t(JSON.parse(this.responseText))},a.open("GET","https://api.data.gov.sg/v1/transport/taxi-availability"),a.setRequestHeader("api-key","QSlWniO8ADQu2BmiVAEueFIxHF4GcaQ9"),a.send()}$header.addEventListener("click",toggleAbout,!1),$aboutOkay.addEventListener("click",toggleAbout,!1),window.localStorage&&!localStorage.getItem("taxirouter-sg:about")&&($about.classList.add("show"),localStorage.setItem("taxirouter-sg:about",1)),mapboxgl.accessToken="pk.eyJ1IjoiY2hlZWF1biIsImEiOiIwMTkyNjRiOWUzOTMyZThkYTE3YjMyMWFiZGU2OTZlNiJ9.XsOEKtyctGiNGNsmVhetYg";var map=new mapboxgl.Map({container:"map",style:"mapbox://styles/mapbox/navigation-preview-night-v2",logoPosition:"top-right",attributionControl:!1,boxZoom:!1});map.addControl(new mapboxgl.AttributionControl({compact:!0}),"top-right"),map.addControl(new mapboxgl.NavigationControl,"top-right");var maxBoundsLike=[[103.6016626883025,1.233357600011331],[104.0381760444838,1.473818072475055]],maxBounds=mapboxgl.LngLatBounds.convert(maxBoundsLike);map.fitBounds(maxBounds,{animate:!1}),map.on("load",function(){for(var t,a=map.getStyle().layers,o=0;o<a.length;o++)if("symbol"===a[o].type&&a[o].layout["text-field"]){t=a[o].id;break}map.addSource("taxis",emptyGeojson),map.addLayer({id:"taxis-heat",type:"heatmap",source:"taxis",maxzoom:15,paint:{"heatmap-radius":11,"heatmap-weight":.1,"heatmap-intensity":.5,"heatmap-color":["interpolate",["linear"],["heatmap-density"],0,"rgba(0,0,255,0)",.1,"yellow",.5,"orange",1,"orangered"]}},t);var e={"icon-padding":0,"icon-size":["interpolate",["linear"],["zoom"],16,.5,22,1.5],"icon-allow-overlap":["step",["zoom"],!1,15,!0],"icon-ignore-placement":["step",["zoom"],!1,15,!0]};map.addSource("taxis-moving",emptyGeojson),map.addLayer({id:"taxis-moving",type:"symbol",source:"taxis-moving",minzoom:12,layout:e},t),map.loadImage("assets/taxi.png",function(t,a){if(t)throw t;map.addImage("taxi",a),map.setLayoutProperty("taxis-moving","icon-image","taxi")}),map.addSource("taxis-stationary",emptyGeojson),map.addLayer({id:"taxis-stationary",type:"symbol",source:"taxis-stationary",minzoom:12,layout:e},t),map.loadImage("assets/taxi-stationary.png",function(t,a){if(t)throw t;map.addImage("taxi-stationary",a),map.setLayoutProperty("taxis-stationary","icon-image","taxi-stationary")}),map.addSource("taxi-stands",{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"MultiPoint",coordinates:taxiStandsOnMap}}}),map.addLayer({id:"taxi-stands",type:"symbol",source:"taxi-stands",minzoom:13,layout:{"icon-padding":0,"icon-size":["interpolate",["linear"],["zoom"],16,.5,22,1.5],"icon-allow-overlap":["step",["zoom"],!1,15,!0],"icon-ignore-placement":["step",["zoom"],!1,15,!0],"icon-anchor":"bottom"}},t),map.loadImage("assets/taxi-stand.png",function(t,a){if(t)throw t;map.addImage("taxi-stand",a),map.setLayoutProperty("taxi-stands","icon-image","taxi-stand")});var i=function(a){map.isSourceLoaded("taxis-moving")&&map.isSourceLoaded("taxis-stationary")&&(requestAnimationFrame(function(){map.addLayer({id:"3d-buildings",source:"composite","source-layer":"building",filter:["==","extrude","true"],type:"fill-extrusion",minzoom:15,paint:{"fill-extrusion-opacity":["interpolate",["linear"],["zoom"],15,0,15.2,.3],"fill-extrusion-color":"#666","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]]}},t)}),map.off("sourcedata",i))};map.on("sourcedata",i);var n=function(){if($infoTaxis.className="loaded",currentLocation&&l){var t=turf.pointsWithinPolygon(turf.points(taxisOnMap.features[0].geometry.coordinates),fiveMinCircle).features.length,a=turf.nearestPoint(turf.point(currentLocation),turf.points(taxiStandsOnMap));if(t&&($infoTaxis.innerHTML="<b>"+numberWithCommas(t)+" available taxis</b> around you.",a)){var o=Math.ceil(1e3*a.properties.distanceToPoint/80);$infoTaxis.innerHTML+="<br>Nearest taxi stand is about <b>"+o+" minute"+(1==o?"":"s")+"</b> walk&nbsp;away."}}else{var e=taxisOnMap.features[0].properties.taxi_count;$infoTaxis.innerHTML="<b>"+numberWithCommas(e)+"</b> available taxis!"}},r=function(){requestAnimationFrame(function(){$infoTaxis.className="",fetchTaxis(function(t){if(map.getSource("taxis").setData(t),taxisOnMap){var a=taxisOnMap.features[0].geometry.coordinates.toString(),o=[],e=t.features[0].geometry.coordinates.filter(function(t){var e=a.includes(t.toString());return e||o.push(t),e});map.getSource("taxis-stationary").setData({type:"Feature",geometry:{type:"MultiPoint",coordinates:e}}),map.getSource("taxis-moving").setData({type:"Feature",geometry:{type:"MultiPoint",coordinates:o}})}else map.getSource("taxis-moving").setData(t);taxisOnMap=t,n()}),setTimeout(r,6e4)})};if(r(),navigator.geolocation){map.addSource("current-location-accuracy-radius",emptyGeojson),map.addLayer({id:"current-location-accuracy-radius",type:"fill",source:"current-location-accuracy-radius",layout:{visibility:"none"},paint:{"fill-color":"rgba(66, 133, 244, .2)"}}),map.addSource("current-location-fivemin-radius",emptyGeojson),map.addLayer({id:"current-location-fivemin-radius",type:"line",source:"current-location-fivemin-radius",minzoom:13,layout:{visibility:"none","line-cap":"round"},paint:{"line-width":3,"line-dasharray":[1,3],"line-color":"rgba(66, 133, 244, .75)"}}),map.addLayer({id:"current-location-fivemin-radius-walk",type:"symbol",source:"current-location-fivemin-radius",minzoom:13,layout:{visibility:"none"},layout:{"symbol-placement":"line","symbol-spacing":Math.min(window.innerWidth,window.innerHeight),"text-field":"{title}","text-size":14,"text-pitch-alignment":"viewport","text-anchor":"bottom","text-justify":"left"},paint:{"text-color":"#4285f4","text-halo-color":"rgba(0,0,0,.5)","text-halo-width":1}}),map.addSource("current-location-marker",emptyGeojson),map.addLayer({id:"current-location-marker",type:"circle",source:"current-location-marker",layout:{visibility:"none"},paint:{"circle-radius":6,"circle-color":"#4285f4","circle-stroke-width":3,"circle-stroke-color":"#fff","circle-pitch-alignment":"map"}}),map.loadImage("assets/location-viewport.png",function(t,a){if(t)throw t;map.addImage("location-viewport",a),map.addLayer({id:"current-location-viewport",type:"symbol",source:"current-location-marker",layout:{visibility:"none","icon-ignore-placement":!0,"icon-allow-overlap":!0,"icon-image":"location-viewport","icon-size":.5,"icon-anchor":"bottom","icon-rotation-alignment":"map"}},"current-location-marker")}),$location.style.display="block";var s,c,l=!1,u=!1,m=!1,p=function(){navigator.geolocation.clearWatch(s),console.log("GEOLOCATION clear watch"),u=l=m=currentLocation=!1,map.setLayoutProperty("current-location-accuracy-radius","visibility","none"),map.setLayoutProperty("current-location-fivemin-radius","visibility","none"),map.setLayoutProperty("current-location-fivemin-radius-walk","visibility","none"),map.setLayoutProperty("current-location-marker","visibility","none"),map.setLayoutProperty("current-location-viewport","visibility","none"),$location.classList.remove("locating","active"),sessionStorage.removeItem("taxirouter-sg:watch-location"),n()},d=function(){$location.classList.remove("active","compass"),m=!1,l=!1,n(),c=setTimeout(p,3e5)},y=function(){if(u){var t=mapboxgl.LngLat.convert(currentLocation).toBounds(fiveMinDistance);if(l){if(m)map.stop().fitBounds(t,{padding:50,pitch:0});else{var a=map.getLayoutProperty("current-location-viewport","icon-rotate")||0,o=map.getPitch();map.stop().easeTo({center:currentLocation,zoom:18,pitch:o>=30?o:45,bearing:a})}m=!m,$location.classList.toggle("compass",m)}else map.stop().fitBounds(t,{padding:50,pitch:0});n()}else $location.classList.add("locating"),s=navigator.geolocation.watchPosition(function(t){$location.classList.remove("locating");var a=t.coords,o=[a.longitude,a.latitude];if("#test-geolocation"==location.hash&&(o=[103.843567,1.28434]),""+o!=""+currentLocation){currentLocation=o,console.log("GEOLOCATION start watch",currentLocation);var e=maxBounds.extend(currentLocation);if(maxBounds.toString()===e.toString()){var i=a.accuracy,r=turf.circle(currentLocation,i/1e3);if(fiveMinCircle=turf.circle(currentLocation,fiveMinDistance/1e3,{properties:{title:"5 mins walk"}}),map.getSource("current-location-accuracy-radius").setData(r),map.getSource("current-location-fivemin-radius").setData(fiveMinCircle),map.getSource("current-location-marker").setData({type:"Feature",geometry:{type:"Point",coordinates:o}}),map.setLayoutProperty("current-location-accuracy-radius","visibility","visible"),map.setLayoutProperty("current-location-fivemin-radius","visibility","visible"),map.setLayoutProperty("current-location-fivemin-radius-walk","visibility","visible"),map.setLayoutProperty("current-location-marker","visibility","visible"),map.setLayoutProperty("current-location-viewport","visibility","visible"),u)l&&!map.isMoving()&&map.panTo(o);else{var s=mapboxgl.LngLat.convert(o).toBounds(fiveMinDistance);map.fitBounds(s,{padding:50,pitch:0}),u=!0,l=!0,sessionStorage.setItem("taxirouter-sg:watch-location",1)}n()}else p()}},function(t){p(),setTimeout(y,1e3)},{enableHighAccuracy:!0,timeout:6e4,maximumAge:5e3});$location.classList.add("active"),l=!0,clearTimeout(c),n(),map.once("dragstart",d)};if($location.addEventListener("click",y,!1),sessionStorage.getItem("taxirouter-sg:watch-location")){var g=debounce(function(t){requestAnimationFrame(y),map.off("data",g)},2e3);map.on("data",g)}window.DeviceOrientationEvent&&window.addEventListener("deviceorientation",function(t){if(u&&t&&null!==t.alpha){var a=t.webkitCompassHeading||t.alpha;map.getLayer("current-location-viewport")&&(map.setLayoutProperty("current-location-viewport","visibility","visible"),map.setLayoutProperty("current-location-viewport","icon-rotate",a),m&&!map.isMoving()&&map.easeTo({center:currentLocation,bearing:a}))}},!1)}map.addLayer({id:"max-bounds",type:"fill",source:{type:"geojson",data:{type:"Feature",geometry:{type:"Polygon",coordinates:[[maxBounds.getNorthWest().toArray(),maxBounds.getNorthEast().toArray(),maxBounds.getSouthEast().toArray(),maxBounds.getSouthWest().toArray(),maxBounds.getNorthWest().toArray()]]}}},paint:{"fill-opacity":0}});var v=$("bounds-warning"),f=debounce(function(){!!map.queryRenderedFeatures({layers:["max-bounds"]}).length?v.classList.remove("visible"):v.classList.add("visible")},600);map.on("render",f),$("back-sg").addEventListener("click",function(){v.classList.remove("visible"),map.fitBounds(maxBounds,{animate:!1})},!1)}),$("map").addEventListener("touchmove",function(t){t.preventDefault()},!1);

(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-23235796-7', 'auto');
ga('send', 'pageview');
</script>
</body></html>